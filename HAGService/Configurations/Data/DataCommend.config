<?xml version="1.0" encoding="utf-8" ?>
<DataCommendConfiguration>
  <DataCommend name="TestDataCommand" database="HAGDB">
    <![CDATA[
    SELECT top 1 
  FROM [HAGDB].[dbo].[Mission]
    ]]>
  </DataCommend>
  <DataCommend name="CreateHAGMember" database="HAGDB">
    <![CDATA[
    INSERT INTO [HAGDB].[dbo].[Mission]
           ([MemberId]
           ,[Title]
           ,[Description]
           ,[MissionType]
           ,[MissionSubType]
           ,[ZipCode]
           ,[Country]
           ,[Address]
           ,[Latitude]
           ,[Longitude]
           ,[TotalStar]
           ,[TaxesStar]
           ,[Star]
           ,[ImageList]
           ,[InDate]
           ,[LastEdit]
           ,[Contact]
           ,[Status]
           ,[IsBlock]
           ,[MissionStartTime]
           ,[MissionEndTime]
           ,[HelpStartTime]
           ,[ResolveTime])
     VALUES
           (@MemberId
           ,@Title
           ,@Description
           ,@MissionType
           ,-1
           ,@ZipCode
           ,'TW'
           ,@Address
           ,@Latitude
           ,@Longitude
           ,@TotalStar
           ,@TaxesStar
           ,@Star
           ,''
           ,GETDATE()
           ,GETDATE()
           ,@Contact
           ,'W'
           ,'0'
           ,GETDATE()
           ,GETDATE()
           ,null
           ,null)
    ]]>
  </DataCommend>
  <DataCommend name="GetHAGMissionById" database="HAGDB">
    <![CDATA[
    SELECT [MissionId]
      ,[MemberId]
      ,[Title]
      ,[Description]
      ,[MissionType]
      ,[MissionSubType]
      ,[ZipCode]
      ,[Country]
      ,[Address]
      ,[Latitude]
      ,[Longitude]
      ,[TotalStar]
      ,[TaxesStar]
      ,[Star]
      ,[ImageList]
      ,[InDate]
      ,[LastEdit]
      ,[Contact]
      ,[Status]
      ,[IsBlock]
      ,[MissionStartTime]
      ,[MissionEndTime]
      ,[HelpStartTime]
      ,[ResolveTime]
  FROM [HAGDB].[dbo].[Mission]
  WHERE MissionId in (@MissionIds)
    ]]>
  </DataCommend>
  <DataCommend name="InsertMsgReqeustAsk" database="HAGDB">
    <![CDATA[
    INSERT INTO [dbo].[MissionMessage]
           ([MemberId]
           ,[MessageType]
           ,[MessageTitle]
           ,[MessageDetail]
           ,[InDate]
           ,[LastEdit]
           ,[MissionId]
           ,[Active]
           ,[Accept]
           ,[ParentMessageId])
     VALUES
           (@MemberId
           ,@MessageType
           ,@MessageTitle
           ,@MessageDetail
           ,GETDATE()
           ,GETDATE()
           ,@MissionId
           ,1
           ,0
           ,@ParentMessageId)
    ]]>
  </DataCommend>
  <DataCommend name="InsertMsgReqeustAnswer" database="HAGDB">
    <![CDATA[
    INSERT INTO [dbo].[MissionMessage]
           ([MemberId]
           ,[MessageType]
           ,[MessageTitle]
           ,[MessageDetail]
           ,[InDate]
           ,[LastEdit]
           ,[MissionId]
           ,[Active]
           ,[Accept]
           ,[ParentMessageId])
     VALUES
           (@MemberId
           ,@MessageType
           ,@MessageTitle
           ,@MessageDetail
           ,GETDATE()
           ,GETDATE()
           ,@MissionId
           ,1
           ,0
           ,@ParentMessageId)
    ]]>
  </DataCommend>
  <DataCommend name="GetMsgReqeustList" database="HAGDB">
    <![CDATA[
    SELECT [TransactionNumber]
          ,[MemberId]
          ,[MessageType]
          ,[MessageTitle]
          ,[MessageDetail]
          ,[InDate]
          ,[LastEdit]
          ,[MissionId]
          ,[Active]
          ,[Accept]
          ,[ParentMessageId]
      FROM [dbo].[MissionMessage]
      WHERE [MissionId] = @MissionId
	    ORDER BY [LastEdit]
    ]]>
  </DataCommend>
  <DataCommend name="CheckMissionMsgAsk" database="HAGDB">
    <![CDATA[
    EXECUTE [dbo].[HAG_SP_CheckMissionMsgAsk] @MissionId, @MemberId
    ]]>
  </DataCommend>
  <DataCommend name="CheckMissionMsgAnswer" database="HAGDB">
    <![CDATA[
    EXECUTE [dbo].[HAG_SP_CheckMissionMsgAnswer] @MissionId, @MissionMessageId
    ]]>
  </DataCommend>
  <DataCommend name="UpdateMissionMsgAsk" database="HAGDB">
    <![CDATA[
    UPDATE [dbo].[MissionMessage]
    SET [LastEdit] = GETDATE()
      ,[Accept] = @Accept
    WHERE [TransactionNumber] = @MissionMessageId
    ]]>
  </DataCommend>
  <DataCommend name="UpdateMissionStatus" database="HAGDB">
    <![CDATA[
    UPDATE [dbo].[Mission]
     SET [LastEdit] = GETDATE()
        ,[Status] = @Status
        ,[HelpStartTime] = GETDATE()
    WHERE [MissionId] = @MissionId
    ]]>
  </DataCommend>
</DataCommendConfiguration>